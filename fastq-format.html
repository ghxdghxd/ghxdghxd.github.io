<div class="header">
  <h1 class="page-title">
    <a class="icon circle-icon glyphicon glyphicon-chevron-left trigger-message-close"></a>
    FASTQ格式详解
  </h1>
  <div class="details">
    <div class="left">
      12月 04, 2014
      <span> | </span> <a href="/category/sheng-xin-shu-ju.html">生信数据</a>
    </div>
    <div class="right">
      <a class="fa fa-tag" href="/tag/ngs.html">NGS</a>
      <a class="fa fa-tag" href="/tag/fastq.html">fastq</a>
      <a class="fa fa-tag" href="/tag/bioinfo.html">bioinfo</a>
    </div>
  </div>
</div>
<div id="message-nano-wrapper" class="nano">
  <div class="nano-content">
    <ul class="message-container">
        <div class="message">
          <p><strong>FASTQ</strong>是基于文本的，保存生物序列（通常是核酸序列）和其测序质量信息的标准格式。
其序列以及质量信息都是使用一个ASCII字符标示，最初由Sanger开发，目的是将FASTA序列与质量数据放到一起，目前已经成为高通量测序结果的事实标准。</p>
<hr />
<h1>FASTQ基本格式(reads)</h1>
<ul>
<li>
<p>每条reads包括4行：</p>
</li>
<li>
<p>序列标识以及相关的描述信息，以‘@’开头；</p>
</li>
<li>第二行是序列</li>
<li>第三行以‘+’开头，后面是序列标示符、描述信息，或者什么也不加</li>
<li>第四行，是质量信息，和第二行的序列相对应，每一个序列都有一个质量评分，根据评分体系的不同，每个字符的含义表示的数字也不相同。</li>
</ul>
<div class="highlight"><pre><span class="code-line"><span></span>1 @SEQ_ID</span>
<span class="code-line">2 GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT</span>
<span class="code-line">3 \+</span>
<span class="code-line">4 !&#39;&#39;*((((***+))%%%++)(%%%%).1***-+*&#39;&#39;))**55CCF&gt;&gt;&gt;&gt;&gt;&gt;CCCCCCC65</span>
</pre></div>


<h2>Fastq ID</h2>
<p>illumina测序仪的ID行一般包含测序仪、运行编号、flowcell ID、lane ID、tile ID、横纵轴坐标、索引序列等等</p>
<h2>质量信息</h2>
<ul>
<li>质量信息代表一个碱基的错误概率的对数值</li>
<li>Phred quality scores are logarithmically linked to error probabilities Phred</li>
</ul>
<p>$$Q=-10log_{10}P$$</p>
<ul>
<li>质量得分与错误概率的对应关系见下表：</li>
</ul>
<table>
<thead>
<tr>
<th>Phred Quality Score (Q)</th>
<th>Probability of incorrect base call</th>
<th>Base call accuracy (P)</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>1 in 10</td>
<td>90 %</td>
</tr>
<tr>
<td>20</td>
<td>1 in 100</td>
<td>99 %</td>
</tr>
<tr>
<td>30</td>
<td>1 in 1000</td>
<td>99.9 %</td>
</tr>
<tr>
<td>40</td>
<td>1 in 10000</td>
<td>99.99 %</td>
</tr>
<tr>
<td>50</td>
<td>1 in 100000</td>
<td>99.999 %</td>
</tr>
</tbody>
</table>
<p>除了Phred质量得分换算标准，还有就是Solexa标准：
$$Q_{solexa-prior to v.1.3}=-10log_{10}\frac{P}{1-P}$$</p>
<p>两种换算标准的比较：
<img alt="compare" src="./images/fastq_quality_compare.png" /></p>
<p>Relationship between Q and p using the Sanger (red) and Solexa (black)
equations (described above). The vertical dotted line indicates p = 0.05, or
equivalently, Q ≈ 13.</p>
<ul>
<li>对于每个碱基的质量编码标示，不同的软件采用不同的方案，目前有5种方案：</li>
<li>Sanger，Phred quality score，值的范围从0到92，对应的ASCII码从33到126，但是对于测序数据（raw read data）质量得分通常小于60，序列拼接或者mapping可能用到更大的分数。</li>
<li>Solexa/Illumina 1.0, Solexa/Illumina quality score，值的范围从-5到63，对应的ASCII码从59到126，对于测序数据，得分一般在-5到40之间；</li>
<li>Illumina 1.3+，<a href="http://en.wikipedia.org/wiki/Phred_quality_score">Phred quality score</a>，值的范围从0到62对应的ASCII码从64到126，低于测序数据，得分在0到40之间；</li>
<li>Illumina 1.5+，Phred quality score，但是0到2作为另外的标示，<a href="http://solexaqa.sourceforge.net/questions.htm#illumina">详见</a></li>
<li>Illumina 1.8+</li>
</ul>
<div class="highlight"><pre><span class="code-line"><span></span>SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS.....................................................</span>
<span class="code-line">      ..........................XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX......................</span>
<span class="code-line">      ...............................IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII......................</span>
<span class="code-line">      .................................**J**JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ......................</span>
<span class="code-line">      LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL....................................................</span>
<span class="code-line">      !&quot;#$%&amp;&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~</span>
<span class="code-line">      |                         |    |        |                              |                     |</span>
<span class="code-line">     33                        59   64       73                            104                   126</span>
<span class="code-line">     S - Sanger        Phred+33,  raw reads typically (0, 40)</span>
<span class="code-line">     X - Solexa        Solexa+64, raw reads typically (-5, 40)</span>
<span class="code-line">     I - Illumina 1.3+ Phred+64,  raw reads typically (0, 40)</span>
<span class="code-line">     J - Illumina 1.5+ Phred+64,  raw reads typically (3, 40)</span>
<span class="code-line">        with 0=unused, 1=unused, 2=Read Segment Quality Control Indicator (bold)</span>
<span class="code-line">        (Note: See discussion above).</span>
<span class="code-line">     L - Illumina 1.8+ Phred+33,  raw reads typically (0, 41)</span>
</pre></div>


<h1>fastq 质量检测工具</h1>
<ul>
<li><a href="/BioKits/fastqc">fastQC</a></li>
</ul>
        </div>
        <!-- <div class="tool-box">
          <a href="#" class="circle-icon small glyphicon glyphicon-share-alt"></a>
          <a href="#" class="circle-icon small red-hover glyphicon glyphicon-remove"></a>
          <a href="#" class="circle-icon small red-hover glyphicon glyphicon-flag"></a>
        </div> -->
    </ul>
  </div>
</div>

<script>
  $('.nano').overlayScrollbars({
    scrollbars: {
      autoHide: "leave",
    }
  });
  $('.trigger-message-close').on('click', function () {
    $('body').removeClass('show-message');
    $('#main .message-list li').removeClass('active');
    messageIsOpen = false;
    $('body').removeClass('show-main-overlay');
  });
  $('#message .header .left a').on('click', function (e) {
    e.preventDefault();
    helper.setQuery().clearRefinements().addDisjunctiveFacetRefinement("category", e.target.text).search();
    
  });
  $('#message .header .right a').on('click', function (e) {
    e.preventDefault();
    helper.setQuery().clearRefinements().addFacetRefinement("tags", e.target.text).search();
  });
</script>