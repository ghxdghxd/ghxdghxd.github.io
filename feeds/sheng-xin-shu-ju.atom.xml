<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>iKnowledgeBase - 生信数据</title><link href="https://ghxdghxd.github.io/" rel="alternate"></link><link href="https://ghxdghxd.github.io/feeds/sheng-xin-shu-ju.atom.xml" rel="self"></link><id>https://ghxdghxd.github.io/</id><updated>2016-02-29T20:40:00+08:00</updated><entry><title>如何根据测序数据计算出数据量以及测序深度？</title><link href="https://ghxdghxd.github.io/NGS-coverage.html" rel="alternate"></link><published>2014-12-04T16:35:00+08:00</published><updated>2016-02-29T20:40:00+08:00</updated><author><name>JT Guo</name></author><id>tag:ghxdghxd.github.io,2014-12-04:/NGS-coverage.html</id><summary type="html">&lt;p&gt;根据测序数据(reads)统计数据量以及测序深度&lt;/p&gt;</summary><content type="html">&lt;html&gt;&lt;body&gt;&lt;ol&gt;
&lt;li&gt;数据量大小&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;单端测序&lt;/strong&gt; 数据量 = reads长度 * reads数
&lt;strong&gt;双端测序&lt;/strong&gt; 数据量 = 单端reads长度 * 单端reads个数 * 2&lt;/p&gt;
&lt;p&gt;注：&lt;strong&gt;单位换算&lt;/strong&gt; 1个碱基=1bp 1kb=1024bp 1M=1024kb 1G=1024M&lt;/p&gt;
&lt;p&gt;2.测序深度&lt;/p&gt;
&lt;p&gt;测序深度 = 数据量大小 / 参考基因组大小&lt;/p&gt;
&lt;p&gt;3.测序与物理覆盖度&lt;/p&gt;
&lt;p&gt;在PE测序文库中&lt;/p&gt;
&lt;p&gt;&lt;img alt="coverage" src="images/coverage.png"/&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</content><category term="NGS"></category></entry><entry><title>FASTQ格式详解</title><link href="https://ghxdghxd.github.io/fastq-format.html" rel="alternate"></link><published>2014-12-04T10:20:00+08:00</published><updated>2015-03-06T16:12:00+08:00</updated><author><name>JT Guo</name></author><id>tag:ghxdghxd.github.io,2014-12-04:/fastq-format.html</id><summary type="html">&lt;p&gt;Fastq的格式&lt;/p&gt;</summary><content type="html">&lt;html&gt;&lt;body&gt;&lt;p&gt;&lt;strong&gt;FASTQ&lt;/strong&gt;是基于文本的，保存生物序列（通常是核酸序列）和其测序质量信息的标准格式。
其序列以及质量信息都是使用一个ASCII字符标示，最初由Sanger开发，目的是将FASTA序列与质量数据放到一起，目前已经成为高通量测序结果的事实标准。&lt;/p&gt;
&lt;hr/&gt;
&lt;h1&gt;FASTQ基本格式(reads)&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;每条reads包括4行：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;序列标识以及相关的描述信息，以‘@’开头；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;第二行是序列&lt;/li&gt;
&lt;li&gt;第三行以‘+’开头，后面是序列标示符、描述信息，或者什么也不加&lt;/li&gt;
&lt;li&gt;第四行，是质量信息，和第二行的序列相对应，每一个序列都有一个质量评分，根据评分体系的不同，每个字符的含义表示的数字也不相同。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;1 @SEQ_ID&lt;/span&gt;
&lt;span class="code-line"&gt;2 GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT&lt;/span&gt;
&lt;span class="code-line"&gt;3 \+&lt;/span&gt;
&lt;span class="code-line"&gt;4 !''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;CCCCCCC65&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Fastq ID&lt;/h2&gt;
&lt;p&gt;illumina测序仪的ID行一般包含测序仪、运行编号、flowcell ID、lane ID、tile ID、横纵轴坐标、索引序列等等&lt;/p&gt;
&lt;h2&gt;质量信息&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;质量信息代表一个碱基的错误概率的对数值&lt;/li&gt;
&lt;li&gt;Phred quality scores are logarithmically linked to error probabilities Phred&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$$Q=-10log_{10}P$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;质量得分与错误概率的对应关系见下表：&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Phred Quality Score (Q)&lt;/th&gt;
&lt;th&gt;Probability of incorrect base call&lt;/th&gt;
&lt;th&gt;Base call accuracy (P)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;1 in 10&lt;/td&gt;
&lt;td&gt;90 %&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;1 in 100&lt;/td&gt;
&lt;td&gt;99 %&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;1 in 1000&lt;/td&gt;
&lt;td&gt;99.9 %&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;1 in 10000&lt;/td&gt;
&lt;td&gt;99.99 %&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;td&gt;1 in 100000&lt;/td&gt;
&lt;td&gt;99.999 %&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;除了Phred质量得分换算标准，还有就是Solexa标准：
$$Q_{solexa-prior to v.1.3}=-10log_{10}\frac{P}{1-P}$$&lt;/p&gt;
&lt;p&gt;两种换算标准的比较：
&lt;img alt="compare" src="./images/fastq_quality_compare.png"/&gt;&lt;/p&gt;
&lt;p&gt;Relationship between Q and p using the Sanger (red) and Solexa (black)
equations (described above). The vertical dotted line indicates p = 0.05, or
equivalently, Q ≈ 13.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对于每个碱基的质量编码标示，不同的软件采用不同的方案，目前有5种方案：&lt;/li&gt;
&lt;li&gt;Sanger，Phred quality score，值的范围从0到92，对应的ASCII码从33到126，但是对于测序数据（raw read data）质量得分通常小于60，序列拼接或者mapping可能用到更大的分数。&lt;/li&gt;
&lt;li&gt;Solexa/Illumina 1.0, Solexa/Illumina quality score，值的范围从-5到63，对应的ASCII码从59到126，对于测序数据，得分一般在-5到40之间；&lt;/li&gt;
&lt;li&gt;Illumina 1.3+，&lt;a href="http://en.wikipedia.org/wiki/Phred_quality_score"&gt;Phred quality score&lt;/a&gt;，值的范围从0到62对应的ASCII码从64到126，低于测序数据，得分在0到40之间；&lt;/li&gt;
&lt;li&gt;Illumina 1.5+，Phred quality score，但是0到2作为另外的标示，&lt;a href="http://solexaqa.sourceforge.net/questions.htm#illumina"&gt;详见&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Illumina 1.8+&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS.....................................................&lt;/span&gt;
&lt;span class="code-line"&gt;      ..........................XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX......................&lt;/span&gt;
&lt;span class="code-line"&gt;      ...............................IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII......................&lt;/span&gt;
&lt;span class="code-line"&gt;      .................................**J**JJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ......................&lt;/span&gt;
&lt;span class="code-line"&gt;      LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL....................................................&lt;/span&gt;
&lt;span class="code-line"&gt;      !"#$%&amp;amp;'()*+,-./0123456789:;&amp;lt;=&amp;gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~&lt;/span&gt;
&lt;span class="code-line"&gt;      |                         |    |        |                              |                     |&lt;/span&gt;
&lt;span class="code-line"&gt;     33                        59   64       73                            104                   126&lt;/span&gt;
&lt;span class="code-line"&gt;     S - Sanger        Phred+33,  raw reads typically (0, 40)&lt;/span&gt;
&lt;span class="code-line"&gt;     X - Solexa        Solexa+64, raw reads typically (-5, 40)&lt;/span&gt;
&lt;span class="code-line"&gt;     I - Illumina 1.3+ Phred+64,  raw reads typically (0, 40)&lt;/span&gt;
&lt;span class="code-line"&gt;     J - Illumina 1.5+ Phred+64,  raw reads typically (3, 40)&lt;/span&gt;
&lt;span class="code-line"&gt;        with 0=unused, 1=unused, 2=Read Segment Quality Control Indicator (bold)&lt;/span&gt;
&lt;span class="code-line"&gt;        (Note: See discussion above).&lt;/span&gt;
&lt;span class="code-line"&gt;     L - Illumina 1.8+ Phred+33,  raw reads typically (0, 41)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;h1&gt;fastq 质量检测工具&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="/BioKits/fastqc"&gt;fastQC&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;</content><category term="NGS"></category><category term="fastq"></category><category term="bioinfo"></category></entry></feed>