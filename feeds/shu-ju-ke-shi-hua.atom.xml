<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>iKnowledgeBase - 数据可视化</title><link href="https://ghxdghxd.github.io/" rel="alternate"></link><link href="https://ghxdghxd.github.io/feeds/shu-ju-ke-shi-hua.atom.xml" rel="self"></link><id>https://ghxdghxd.github.io/</id><updated>2018-11-01T13:33:00+08:00</updated><entry><title>饼图</title><link href="https://ghxdghxd.github.io/pie_plot.html" rel="alternate"></link><published>2018-11-01T13:33:00+08:00</published><updated>2018-11-01T13:33:00+08:00</updated><author><name>JT Guo</name></author><id>tag:ghxdghxd.github.io,2018-11-01:/pie_plot.html</id><summary type="html">&lt;p&gt;饼图的实现方法&lt;/p&gt;</summary><content type="html">&lt;h1&gt;饼图&lt;/h1&gt;
&lt;p&gt;图例设置
labs(fill="fill-legend-title", )
图例排列
guides(fill = guide_legend(nrow = 1))&lt;/p&gt;</content><category term="pie"></category></entry><entry><title>ROC曲线</title><link href="https://ghxdghxd.github.io/ROC.html" rel="alternate"></link><published>2018-03-12T09:58:00+08:00</published><updated>2016-06-14T14:02:00+08:00</updated><author><name>JT Guo</name></author><id>tag:ghxdghxd.github.io,2018-03-12:/ROC.html</id><summary type="html">&lt;p&gt;ROC曲线&lt;/p&gt;</summary><content type="html">&lt;h1&gt;ROC曲线&lt;/h1&gt;
&lt;p&gt;接收者操作特征曲线 （receiver operating characteristic curve），简称ROC曲线是一种坐标图式的分析工具，用于：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;选择最佳的信号侦测模型、舍弃次佳的模型&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在同一模型中设定最佳阈值&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ROC分析的是二元分类模型（如阳性/阳性，有病/没病）：&lt;/p&gt;
&lt;p&gt;&lt;img alt="ROC1" src="./images/ROC1.png" style="width:50%" /&gt;&lt;/p&gt;
&lt;h1&gt;ROC空间&lt;/h1&gt;
&lt;p&gt;ROC空间将伪阳性率（FPR）定义为 X 轴，真阳性率（TPR）定义为 Y 轴。&lt;/p&gt;
&lt;p&gt;TPR：在所有实际为阳性的样本中，被正确地判断为阳性之比率。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;TPR=TP/(TP+FN)&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;FPR：在所有实际为阴性的样本中，被错误地判断为阳性之比率。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;FPR=FP/(FP+TN)&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="ROC"></category></entry><entry><title>QQplot</title><link href="https://ghxdghxd.github.io/QQplot.html" rel="alternate"></link><published>2015-12-27T19:57:00+08:00</published><updated>2015-12-27T19:57:00+08:00</updated><author><name>JT Guo</name></author><id>tag:ghxdghxd.github.io,2015-12-27:/QQplot.html</id><summary type="html">&lt;p&gt;QQplot在GWAS中的意思&lt;/p&gt;</summary><content type="html">&lt;h1&gt;QQplot&lt;/h1&gt;
&lt;p&gt;Q-Q plot 即Quantile-Quantile Plot。它在各类研究中经常用到，主要是直观的表示观测值与预测值之间的差异。&lt;/p&gt;
&lt;p&gt;在SPSS中很容做，Analysis - Descriptive statistics - Q-Qplot。&lt;/p&gt;
&lt;p&gt;Q-Q plot主要是用来估计数量性状观测值与预测值之间的差异。一般我们所取得的数量性状数据都为正态分布数据。在GWAS研究中Q-Q
plot的X和Y轴主要是代表各个SNP的-lg P values。预测的线是一条从原点发出的45°角的虚线。实际观测值则是标的实心点。&lt;/p&gt;
&lt;p&gt;Q-Q plot主要要点：&lt;/p&gt;
&lt;p&gt;预测的虚线为什么是45°出来的呢？因为预测的线实际是通过在QQ图中第一象限作图得出。理论上一个点A在该图上的位置应该是A预测值=A实际值，转化为坐标就是A（x，y）x=y。所以预测的线是一条从原点发出的45°线。&lt;/p&gt;
&lt;p&gt;观测值的点的坐标是怎么得出来的。同样设点A的坐标是（x，y）x为预测值，y为实际观测值。查了一下R 中qq plot的算法是这样的&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;pvals &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; read.table&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;DGI_chr3_pvals.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; header&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;observed &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;pvals&lt;span class="o"&gt;$&lt;/span&gt;PVAL&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;lobs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;observed&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;expected &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;observed&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;lexp &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;expected &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;expected&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="m"&gt;+1&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;具体解释是这样的，先把P值从小到大排序。lobs代表纵坐标，lexp代表横坐标，纵坐标就是观测P值的-
log10，而横坐标则根据P值数目而定。比如，当只有3个P值 P1=0.0001 P2=0.001
P3=0.01，那么在这个P值组中，length(observed)=3，对于P1=0.0001 expected=1
lexp=-log10（1/3+1），对于P2=0.001 expected=2 lexp=-log10（2/3+1）， P3=0.01
expected=3 lexp=-log10（3/3+1）。。。。。依此类推。&lt;/p&gt;
&lt;p&gt;如果出现了偏离的情况说明实际值跟预测值有偏差，在GWAS研究中，那个SNP点出现了较大的偏离，则认为这个SNP位点的观测值的偏离是由这个SNP突变所产生的遗传作用造成的&lt;/p&gt;</content><category term="QQplot"></category></entry></feed>